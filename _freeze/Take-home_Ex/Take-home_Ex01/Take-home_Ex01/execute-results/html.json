{
  "hash": "92f7304dea48995ba94bc36f67c2905e",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Take-home Exercise 01: Visualizing and Uncovering Trends on Heart Attacks in Japan\"\nformat: html\nauthor: \"Sei Sar Hla Kyi\"\ndate: \"2025-02-03\"\ndate-modified: \"2025-02-03\"\nexecute: \n  eval: true\n  echo: true\n  message: false\n  freeze: true\n  warning: false\n---\n\n\n\n# 1 Overview\n\n## 1.1 Background\n\nHeart disease remains one of the leading causes of mortality worldwide, and Japan is no exception. Despite the country's reputation for longevity and a traditionally healthy diet, heart-related health issues—including heart attacks—continue to be a significant public health concern. The impact of heart attacks varies across different age groups, with risk factors and outcomes often differing between younger and older individuals. While Japan’s aging population naturally sees a higher prevalence of heart attacks among adults, recent trends suggest that younger individuals are also increasingly at risk, raising concerns about lifestyle habits and diet.\n\nHistorically, Japan’s diet—rich in fish, vegetables, and low in saturated fats—has been associated with lower cardiovascular disease rates. However, research by Iso (2011) has highlighted a gradual shift toward Westernized dietary patterns, characterized by increased consumption of meat and processed foods, which has contributed to rising cholesterol levels and a greater risk of heart disease. Additionally, lifestyle factors such as physical inactivity, smoking, and alcohol consumption have played a role in shaping cardiovascular health trends within the country.\n\nMedical advancements and early interventions have improved survival rates, but the rising burden of cardiovascular diseases still calls for further research and public awareness.\n\n## 1.2 Objectives\n\nThis exercise aims to explore the patterns of heart attacks in Japan across different age groups and shedding light on key factors contributing to their occurrence. By examining trends, potential risk factors, and demographic variations, I seek to provide insights into how heart attack cases differ between youth and adults.\n\nThrough data-driven visualizations, I will highlight the prevalence, underlying causes, and potential warning signs associated with heart attacks in Japan. The goal is to help healthcare professionals, policymakers, and the general public better understand the evolving landscape of cardiovascular health and to encourage proactive measures for prevention and early detection.\n\n------------------------------------------------------------------------\n\n# 2 Methodology & R Packages Used\n\nI will follow the outlined methodology flow for this exercise, starting with data import, followed by data preparation, and concluding with statistical graphics, including exploratory analysis to draw insights.\n\n![](/Take-home_Ex/Methodology.png)\n\nThe following R packages will be used to achieve the objective.\n\n::: panel-tabset\n## Packages Used\n\n| Package | Explanation |\n|------------------------------------|------------------------------------|\n| tidyverse | to efficiently manipulate and clean data, utilizing functions from packages like `dplyr` and `tidyr` for data wrangling. |\n| ggplot2 | to create informative and aesthetically pleasing visualizations, such as histograms and boxplots, to analyze the data |\n| patchwork | to combine multiple ggplot2 plots into a cohesive layout, making it easier to present related visualizations side by side |\n|  |  |\n|  |  |\n|  |  |\n\n## Code to Install and Launch\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npacman::p_load(tidyverse,patchwork)\n```\n:::\n\n\n:::\n\n------------------------------------------------------------------------\n\n# 3 The Dataset\n\nThe dataset, *Heart Attack in Japan: Youth vs. Adult,* used in this analysis was obtained from Kaggle. It contains data for heart attack cases across different age groups.\n\nThis dataset includes both numerical and categorical variables related to cardiovascular health, such as cholesterol levels, blood pressure, heart rate, and lifestyle factors. These indicators are crucial in assessing the likelihood of heart attacks and understanding how risk factors differ between younger and older populations.\n\nIn the next section, we will import the raw dataset and refine it further to ensure its readiness for visual analysis and gain deeper insights.\n\n------------------------------------------------------------------------\n\n# 4 Data Preparation\n\n## 4.1 Importing the Data\n\nThe code chunk below imports *japan_heart_attack_dataset.csv* into R environment by using *read_csv()* function of **readr** package. **readr** is one of the tidyverse package.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nheartattack_data <- read_csv(\"data/raw/japan_heart_attack_dataset.csv\")\n```\n:::\n\n\n\nLet's view the structure of the dataset using *glimpse()*, which allows us to see data structure and variable names as well as types.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nglimpse(heartattack_data)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nRows: 30,000\nColumns: 32\n$ Age                     <dbl> 56, 69, 46, 32, 60, 25, 78, 38, 56, 75, 36, 40…\n$ Gender                  <chr> \"Male\", \"Male\", \"Male\", \"Female\", \"Female\", \"F…\n$ Region                  <chr> \"Urban\", \"Urban\", \"Rural\", \"Urban\", \"Rural\", \"…\n$ Smoking_History         <chr> \"Yes\", \"No\", \"Yes\", \"No\", \"No\", \"No\", \"No\", \"Y…\n$ Diabetes_History        <chr> \"No\", \"No\", \"No\", \"No\", \"No\", \"No\", \"Yes\", \"No…\n$ Hypertension_History    <chr> \"No\", \"No\", \"No\", \"No\", \"No\", \"No\", \"Yes\", \"No…\n$ Cholesterol_Level       <dbl> 186.4002, 185.1367, 210.6966, 211.1655, 223.81…\n$ Physical_Activity       <chr> \"Moderate\", \"Low\", \"Low\", \"Moderate\", \"High\", …\n$ Diet_Quality            <chr> \"Poor\", \"Good\", \"Average\", \"Good\", \"Good\", \"Go…\n$ Alcohol_Consumption     <chr> \"Low\", \"Low\", \"Moderate\", \"High\", \"High\", \"Hig…\n$ Stress_Levels           <dbl> 3.644786, 3.384056, 3.810911, 6.014878, 6.8068…\n$ BMI                     <dbl> 33.96135, 28.24287, 27.60121, 23.71729, 19.771…\n$ Heart_Rate              <dbl> 72.30153, 57.45764, 64.65870, 55.13147, 76.667…\n$ Systolic_BP             <dbl> 123.90209, 129.89331, 145.65490, 131.78522, 10…\n$ Diastolic_BP            <dbl> 85.68281, 73.52426, 71.99481, 68.21133, 92.902…\n$ Family_History          <chr> \"No\", \"Yes\", \"No\", \"No\", \"No\", \"No\", \"No\", \"No…\n$ Heart_Attack_Occurrence <chr> \"No\", \"No\", \"No\", \"No\", \"No\", \"No\", \"No\", \"No\"…\n$ Extra_Column_1          <dbl> 0.40498852, 0.03627815, 0.85297888, 0.39085280…\n$ Extra_Column_2          <dbl> 0.43330004, 0.51256694, 0.21959083, 0.29684675…\n$ Extra_Column_3          <dbl> 0.62871236, 0.66839275, 0.61343656, 0.15572404…\n$ Extra_Column_4          <dbl> 0.70160955, 0.11552874, 0.50800995, 0.87025144…\n$ Extra_Column_5          <dbl> 0.49814235, 0.42381938, 0.90066981, 0.39035591…\n$ Extra_Column_6          <dbl> 0.007901312, 0.083932768, 0.227205241, 0.40318…\n$ Extra_Column_7          <dbl> 0.79458257, 0.68895108, 0.49634358, 0.74140891…\n$ Extra_Column_8          <dbl> 0.29077922, 0.83016364, 0.75210679, 0.22396813…\n$ Extra_Column_9          <dbl> 0.49719307, 0.63449028, 0.18150125, 0.32931387…\n$ Extra_Column_10         <dbl> 0.52199452, 0.30204337, 0.62918031, 0.14319054…\n$ Extra_Column_11         <dbl> 0.79965663, 0.04368285, 0.01827617, 0.90778075…\n$ Extra_Column_12         <dbl> 0.72239788, 0.45166789, 0.06322702, 0.54232201…\n$ Extra_Column_13         <dbl> 0.1487387, 0.8786714, 0.1465122, 0.9224606, 0.…\n$ Extra_Column_14         <dbl> 0.8340099, 0.5356022, 0.9972962, 0.6262165, 0.…\n$ Extra_Column_15         <dbl> 0.061632229, 0.617825340, 0.974455410, 0.22860…\n```\n\n\n:::\n:::\n\n\n\nAt a glimpse, we see that there at 32,000 rows and 32 columns.\n\n## 4.2 Filtering for Relevant Variables\n\nWe notice that there were certain columns titled \"Extra_Column\\_\" from column number 18 to 32. We will remove these columns as there are no explanations in the metadata from the source, leaving us with 17 variables to work with.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nheartattack_data <- heartattack_data %>% select(-c(18:32))\n```\n:::\n\n\n\nWe also notice that this dataset also contains data for people with no heart attack occurrence (in the Heart_Attack_Occurrence column). Since we are performing exploratory data analysis (EDA), it would be valuable to keep both groups, as this allows us to identify and compare characteristics like age, gender, lifestyle, or pre-existing conditions between those who had a heart attack and those who didn't, potentially letting us uncover patterns or trends that can inform your study.\n\n## 4.3 Convert Data Types\n\nWe note that all variables are in the correct data types. However, we will convert the Binary columns (Yes/No) such as Smoking_History,Diabetes_History, Hypertension_History, Family_History and Heart_Attack_Occurrence as factor for better visualisation.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nheartattack_data$Smoking_History <- factor(heartattack_data$Smoking_History, levels = c(\"No\", \"Yes\"))\n\nheartattack_data$Diabetes_History <- factor(heartattack_data$Diabetes_History, levels = c(\"No\", \"Yes\"))\n\nheartattack_data$Hypertension_History <- factor(heartattack_data$Hypertension_History, levels = c(\"No\", \"Yes\"))\n\nheartattack_data$Family_History <- factor(heartattack_data$Family_History, levels = c(\"No\", \"Yes\"))\n\nheartattack_data$Heart_Attack_Occurrence <- factor(heartattack_data$Heart_Attack_Occurrence, levels = c(\"No\", \"Yes\"))\n```\n:::\n\n\n\n## 4.3 Checking for Duplicates and Missing values\n\nIt is essential to check for duplicates and missing values before we move forward. We will use the following code to check for them.\n\n::: panel-tabset\n## Checking for Duplicates\n\nThe *duplicated()* function in the **base** package is used to check for duplicates in heartattack_data.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsum(duplicated(heartattack_data))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0\n```\n\n\n:::\n:::\n\n\n\n## Checking for Missing Values\n\nThe *colSums()* function in the **base** package is used to check for missing values in heartattack_data.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncolSums(is.na(heartattack_data))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                    Age                  Gender                  Region \n                      0                       0                       0 \n        Smoking_History        Diabetes_History    Hypertension_History \n                      0                       0                       0 \n      Cholesterol_Level       Physical_Activity            Diet_Quality \n                      0                       0                       0 \n    Alcohol_Consumption           Stress_Levels                     BMI \n                      0                       0                       0 \n             Heart_Rate             Systolic_BP            Diastolic_BP \n                      0                       0                       0 \n         Family_History Heart_Attack_Occurrence \n                      0                       0 \n```\n\n\n:::\n:::\n\n\n:::\n\nThere are no duplicates and missing values in this dataset.\n\n## 4.4 Grouping Variables into Categories\n\nSome numerical variables (represented as \"dbl\" when we checked data structure in section 4.1), will be grouped into the following categories for meaningful insights:\n\n-   **Age:** For this variable which ranges from 18 to 79, we will use equal bins for each category, categorized as:\n\n    -   **Young**: 18–39\n\n    -   **Middle-Aged**: 40–59\n\n    -   **Old**: 60–79\n\n-   **Cholesterol Level:** According to guidelines from the American Heart Association (AHA) and National Heart, Lung, and Blood Institute (NHLBI) (Lauer et al, 2004), a desirable low cholesterol level is Below 200 mg/dL, a borderline high medium would be between 200 to 239 mg/dL and high cholesterol level is considered as 240 mg/dL and above.To align with this finding, we will categorize as:\n\n    -   **Low:** 80–199 mg/dL\n    -   **Medium:** 200–239 mg/dL\n    -   **High:** 240–336 mg/dL\n\n-   **Stress Level:** A common method to measure stress is the Perceived Stress Scale (Cohen,1994) where individuals rate their stress from 0 (no stress) to 10 (extreme stress). Since our dataset usesa 0 to 10 range, it's likely a self-reported scale, where 0-3 represents minimal or manageable stress, 4-6 represents moderate stress and 7-10 represents high to extreme stress, with potential health risks. Therefore, we will categorize the stress levels as:\n\n    -   **Low:** 0.000–3.999\n    -   **Medium:** 4.000–6.999\n    -   **High:** 7.000–10.000\n\n-   **Heart Rate:** According to Mayo Clinic, low/below normal heart rate is below 60 bpm, a normal healthy range is 60–100 bpm, and above normal is above 100 bpm. Aligning with this, our categories will be:\n\n    -   **Low:** 30.000–59.999 bpm\n\n    -   **Normal:** 60.000–99.999 bpm\n\n    -   **High:** 100.000–108.7812 bpm\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nheartattack_data <- heartattack_data %>%\n  mutate(\n    AgeCat = case_when(\n      Age >= 18 & Age <= 39 ~ \"Young\",\n      Age >= 40 & Age <= 59 ~ \"Middle-Aged\",\n      Age >= 60 & Age <= 79 ~ \"Old\"\n    ),\n    \n    Cholesterol = case_when(\n      Cholesterol_Level >= 80.0000 & Cholesterol_Level  <= 199.9999 ~ \"Low\",\n      Cholesterol_Level  >= 200.0000 & Cholesterol_Level  <= 239.9999 ~ \"Medium\",\n      Cholesterol_Level  >= 240.0000 & Cholesterol_Level  <= 336.9999 ~ \"High\"\n    ),\n    \n    Stress = case_when(\n      Stress_Levels >= 0.000 & Stress_Levels <= 3.999999 ~ \"Low\",\n      Stress_Levels > 4.000 & Stress_Levels <= 6.999999 ~ \"Medium\",\n      Stress_Levels > 7.000 & Stress_Levels <= 10.000 ~ \"High\"\n    ),\n    \n    HeartRate = case_when(\n      Heart_Rate >= 30.000 & Heart_Rate <= 59.99999 ~ \"Low\",\n      Heart_Rate > 60.000 & Heart_Rate <= 99.99999 ~ \"Normal\",\n      Heart_Rate > 100.000 & Heart_Rate <= 108.78217 ~ \"High\"\n    )\n  )\n```\n:::\n\n\n\nLastly, save the prepared output to rds format using the following code chunk. We will use this newly prepared data from this point.\n\n::: panel-tabset\n## Save to .rds format\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nwrite_rds(heartattack_data, file = \"data/rds/heartattack.rds\")\n```\n:::\n\n\n\n## Load the rds file\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nheartattack <- read_rds(\"data/rds/heartattack.rds\")\n```\n:::\n\n\n:::\n\n------------------------------------------------------------------------\n\n# 5 Data Visualisation\n\n## 5.1 Starting Big: Overview of Heart Attack Occurrence in Japan\n\n### 5.1.1 Heart Attack Occurrence by Age Group and Gender\n\nWe will first explore the distribution of heart attack occurrences across different age groups and genders in Japan. By categorizing individuals into age groups (Young, Middle-Aged, and Old), we can observe trends in heart attack prevalence, with particular focus on gender differences. This helps identify which demographic groups are more vulnerable and gives us the overview.\n\n::: panel-tabset\n## Plot\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](Take-home_Ex01_files/figure-html/unnamed-chunk-11-1.png){width=672}\n:::\n:::\n\n\n\n## Code\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Compute percentages within each AgeCat-Gender group\nheartattack_summary <- heartattack %>%\n  group_by(AgeCat, Gender, Heart_Attack_Occurrence) %>%\n  summarise(count = n(), .groups = 'drop') %>%\n  group_by(AgeCat, Gender) %>%\n  mutate(percentage = (count / sum(count)) * 100)\n\n# Histogram Plot\nhistograms_age <- ggplot(heartattack_summary, aes(x = AgeCat, y = percentage, fill = Heart_Attack_Occurrence)) +\n  geom_bar(stat = \"identity\", position = \"dodge\") +\n  facet_wrap(~Gender) + \n  geom_text(aes(label = sprintf(\"%.1f%%\", percentage)), \n            position = position_dodge(width = 0.8), \n            vjust = -0.2, size = 3) +  # Display percentages on top of bars\n  labs(x = \"Age Category\",\n       y = \"Percentage of Individuals\",\n       fill = \"Heart Attack\") +\n  scale_fill_manual(values = c(\"No\" = \"#d3d2d1\", \"Yes\" = \"#83bace\")) + \n  theme_minimal(base_size = 14) +\n  theme( \n        axis.title = element_text(size = 10), \n        axis.text = element_text(size = 9),\n        legend.key.size = unit(0.5, \"cm\"),  \n        legend.text = element_text(size = 10),\n        legend.title = element_text(size = 10),\n        strip.text = element_text(size = 10, face = \"bold\"))\n\n# Compute Mean Age to display on Boxplot\nmean_values <- heartattack %>%\n  group_by(Gender, Heart_Attack_Occurrence) %>%\n  summarise(mean_age = mean(Age, na.rm = TRUE), .groups = \"drop\")\n\n# Boxplot\ngenderboxplots <- ggplot(heartattack, aes(x = Heart_Attack_Occurrence, y = Age, fill = Heart_Attack_Occurrence)) +\n  geom_boxplot(alpha = 0.7) +\n  facet_wrap(~Gender) +  \n  stat_summary(\n    aes(y = Age),\n    fun = mean,\n    geom = \"point\",\n    shape = 21, size = 2, color = \"black\", fill = \"#b9d990\"\n  ) + \n  geom_text(\n    data = mean_values,\n    aes(x = Heart_Attack_Occurrence, y = mean_age, label = sprintf(\"Mean = %.1f\", mean_age)),  \n    vjust = -0.5, size = 2, color = \"black\"\n  ) +\n  labs(title = \"Age Distribution by Heart Attack Status & Gender\",\n       x = \"Heart Attack Occurrence\") + \n  scale_fill_manual(values = c(\"No\" = \"#d3d2d1\", \"Yes\" = \"#83bace\")) + \n  theme_minimal(base_size = 12) +\n  theme(\n    plot.title = element_text(size = 12, face = \"bold\"),\n    axis.title = element_text(size = 10),  \n    axis.text = element_text(size = 9), \n    axis.title.y = element_blank(), \n    legend.position = \"none\",\n    strip.text = element_text(size = 10, face = \"bold\")  \n  ) +\n  coord_flip()\n\n# Combine plots using patchwork\ngenderboxplots / histograms_age + \n  plot_layout(heights = c(1, 4))\n```\n:::\n\n\n:::\n\n::: {.callout-note style=\"color: black; background-color: #e0f3f9\"}\n## Insights\n\n-   The **Middle-Aged Male** category shows the highest percentage of individuals who have had a heart attack, at **10.8%**.\n\n-   Both female and male have a similar mean of 48 years for those who have had heart attacks.\n:::\n\n### 5.1.2 Heart Attack Occurrence by Lifestyle Factors (Smoking, Alcohol, Physical Activity, Diet Quality)\n\nLifestyle factors such as smoking, alcohol consumption, physical activity, and diet quality play a significant role in heart attack occurrences. This section visualizes how these factors interact with heart attack risk, providing insights into the relative contributions of each factor. This analysis shows us the importance of lifestyle modifications in preventing heart attacks.\n\n### 5.1.3 Heart Attack Occurrence by Medical History (Diabetes, Hypertension, Family History, Cholesterol Level)\n\nMedical history, including conditions like diabetes, hypertension, family history of heart disease, and high cholesterol, is a critical determinant of heart attack risk. This section aims to reveal which medical conditions are most strongly associated with an increased risk. For example, individuals with a family history of heart disease or high cholesterol levels may be more likely to experience a heart attack.\n\n## 5.2 Narrowing Down: Risk Factors and Their Impact\n\n### **5.2.1 Smoking’s Impact on Heart Attack Occurrence by Age**\n\n### 5.2.2 **Diabetes & Hypertension Impact by Age**\n\n### 5.2.3 **BMI vs. Heart Attack with Physical Activity Levels**\n\n### 5.2.4 **Stress vs. Heart Attack by Gender and Region**\n\n### 5.2.5 **Heart Rate & BP Comparison**\n\n### 5.2.6 **Lifestyle Risk Factor Combinations**\n\n## 5.3 Clinical Insights\n\n### 5.3.1 Correlation between BMI and Heart Attack\n\n### **5.3.2 Blood Pressure vs. Heart Rate Among Heart Attack Patients (Regression)**\n\n------------------------------------------------------------------------\n\n# 6 Summary\n\n------------------------------------------------------------------------\n\n# References\n\nCohen, S. (1994). *Perceived Stress Scale*. Mind Garden. Retrieved from <https://www.mindgarden.com/documents/PerceivedStressScale.pdf>\n\nIso H. (2011). Lifestyle and cardiovascular disease in Japan. *Journal of atherosclerosis and thrombosis*, *18*(2), 83–88. https://doi.org/10.5551/jat.6866\n\nLauer, M. S., Okin, P. M., Larson, M. G., Evans, J. C., Levy, D. (2004). Impaired heart rate response to graded exercise: Prognostic implications of chronotropic incompetence in the Framingham Heart Study. *Circulation, 109*(7), 988–994. [https://doi.org/10.1161/01.CIR.0000141564.89465.4E](https://www.ahajournals.org/doi/10.1161/01.CIR.0000141564.89465.4E)\n\nMayo Clinic. (n.d.). *What’s a normal resting heart rate?* Mayo Clinic. Retrieved February 3, 2025, from <https://www.mayoclinic.org/healthy-lifestyle/fitness/expert-answers/heart-rate/faq-20057979>\n",
    "supporting": [
      "Take-home_Ex01_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}